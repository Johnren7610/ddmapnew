# 🚀 DDmap 生产环境上线检查清单

本文档提供了DDmap项目从开发到生产环境上线的完整检查清单。

## 📋 上线前必需工作

### 🔑 **1. API密钥和第三方服务配置**

#### Google Maps API 设置 ⭐⭐⭐
- [ ] 访问 [Google Cloud Console](https://console.cloud.google.com/)
- [ ] 创建新项目或选择现有项目
- [ ] 启用 **Maps JavaScript API**
- [ ] 生成API密钥
- [ ] **重要**: 设置API密钥限制
  - [ ] HTTP来源限制：添加你的生产域名
  - [ ] API限制：只允许 Maps JavaScript API
- [ ] 测试API密钥是否工作
- [ ] 设置用量警报（防止意外费用）

**费用预估**: 免费额度 $200/月，通常个人项目足够使用

#### 其他可选服务
- [ ] Google Analytics (网站分析)
- [ ] Sentry (错误监控)
- [ ] Cloudflare (CDN和安全)

### 🌐 **2. 部署平台选择和配置**

#### 推荐平台对比

| 平台 | 难度 | 费用 | 适用场景 | 国内访问 |
|------|------|------|----------|----------|
| Vercel | ⭐ | 免费-$20/月 | 个人/小团队 | 较慢 |
| Netlify | ⭐⭐ | 免费-$15/月 | 静态网站 | 一般 |
| 阿里云OSS | ⭐⭐⭐ | ¥5-50/月 | 国内用户 | 很快 |
| GitHub Pages | ⭐ | 免费 | 开源项目 | 较慢 |

#### Vercel 部署 (推荐)
- [ ] 注册 Vercel 账户
- [ ] 连接 GitHub 仓库
- [ ] 配置环境变量:
  ```env
  VITE_GOOGLE_MAPS_API_KEY=your_production_api_key
  VITE_APP_ENV=production
  ```
- [ ] 设置自定义域名 (可选)
- [ ] 配置重定向规则

#### 域名配置 (可选但推荐)
- [ ] 购买域名 (推荐 .com/.cn)
  - 阿里云: ¥55/年 (.com)
  - 腾讯云: ¥55/年 (.com)
  - Godaddy: $12/年 (.com)
- [ ] 配置DNS解析
- [ ] 设置SSL证书 (通常平台自动配置)
- [ ] 测试域名访问

### 🛡️ **3. 安全和性能配置**

#### 安全配置
- [ ] 启用HTTPS (部署平台通常自动配置)
- [ ] 设置安全头 (CSP, HSTS等)
- [ ] 配置CORS策略 (如果有API)
- [ ] 移除开发环境配置和调试信息

#### 性能优化
- [ ] 启用Gzip压缩
- [ ] 配置静态资源缓存
- [ ] 优化图片 (WebP格式, 适当大小)
- [ ] 代码分割和懒加载检查
- [ ] CDN配置 (部署平台通常自动)

### 📊 **4. 监控和分析设置**

#### 基础监控
- [ ] Google Analytics 配置
- [ ] 错误监控 (Sentry) 设置
- [ ] 性能监控配置
- [ ] 正常运行时间监控

#### 日志和调试
- [ ] 生产环境日志配置
- [ ] 错误报告配置
- [ ] 性能指标收集

## 🧪 **生产环境测试清单**

### 功能测试
- [ ] **地图功能**
  - [ ] 地图正常加载和显示
  - [ ] 可以添加标注点
  - [ ] 标注详情正确显示
  - [ ] 悬停和点击交互正常

- [ ] **会员功能**
  - [ ] 会员订阅界面正常
  - [ ] 黑名单功能工作正常
  - [ ] 零小费预警功能正常
  - [ ] 权限控制正确

- [ ] **移动端测试**
  - [ ] 响应式布局正常
  - [ ] 触摸操作流畅
  - [ ] 按钮大小适合触摸
  - [ ] 键盘弹出不影响布局

### 兼容性测试
- [ ] **浏览器兼容性**
  - [ ] Chrome (90+)
  - [ ] Firefox (88+)
  - [ ] Safari (14+)
  - [ ] Edge (90+)

- [ ] **设备兼容性**
  - [ ] Desktop (1920x1080, 1366x768)
  - [ ] Tablet (iPad, Android平板)
  - [ ] Mobile (iPhone, Android手机)

### 性能测试
- [ ] **Core Web Vitals**
  - [ ] LCP < 2.5s (最大内容绘制)
  - [ ] FID < 100ms (首次输入延迟)
  - [ ] CLS < 0.1 (累积布局偏移)

- [ ] **加载速度**
  - [ ] 首次加载 < 3s
  - [ ] 后续导航 < 1s
  - [ ] 地图加载 < 2s

## 📝 **上线部署步骤**

### 自动化部署 (推荐)
```bash
# 1. 确保代码已推送到main分支
git push origin main

# 2. 使用部署脚本
chmod +x scripts/deploy.sh
./scripts/deploy.sh vercel

# 3. 或者手动部署
npm run build
vercel --prod
```

### 手动部署步骤
1. **代码准备**
   ```bash
   git checkout main
   git pull origin main
   npm ci
   ```

2. **环境变量配置**
   ```bash
   cp .env.example .env.production
   # 编辑 .env.production 添加生产环境配置
   ```

3. **构建测试**
   ```bash
   npm run type-check
   npm run lint
   npm run build
   npm run preview  # 预览构建结果
   ```

4. **部署执行**
   - Vercel: `vercel --prod`
   - Netlify: `netlify deploy --prod --dir=dist`
   - GitHub Pages: `npm run deploy`

## 🔍 **上线后验证清单**

### 基础验证
- [ ] 网站可正常访问
- [ ] HTTPS正常工作
- [ ] 所有页面可正常加载
- [ ] 地图API正常工作
- [ ] 移动端访问正常

### 高级验证
- [ ] Google Analytics 数据收集正常
- [ ] 错误监控正常工作
- [ ] 性能指标符合预期
- [ ] SEO基础配置正常

### 用户测试
- [ ] 邀请5-10名用户进行真实使用测试
- [ ] 收集用户反馈
- [ ] 修复关键问题
- [ ] 优化用户体验

## 💰 **费用预估和成本控制**

### 基础费用 (月)
- **域名**: ¥5-10/月 (可选)
- **部署平台**: 免费-¥150/月
- **Google Maps**: 免费额度通常够用
- **CDN**: 通常包含在部署平台中
- **总计**: ¥5-160/月

### 成本控制建议
- [ ] 设置用量警报
- [ ] 定期检查费用账单
- [ ] 优化API调用频率
- [ ] 使用缓存减少重复请求

## 📈 **上线后运营工作**

### 第一周
- [ ] 每日检查网站状态
- [ ] 监控错误日志
- [ ] 收集用户反馈
- [ ] 修复紧急问题

### 第一个月
- [ ] 分析用户行为数据
- [ ] 优化性能瓶颈
- [ ] 完善功能细节
- [ ] 计划下一版本功能

### 长期运营
- [ ] 定期安全更新
- [ ] 性能监控和优化
- [ ] 用户反馈收集和处理
- [ ] 新功能开发和迭代

## 🚨 **应急处理预案**

### 网站无法访问
1. 检查域名DNS解析
2. 检查部署平台状态
3. 检查SSL证书状态
4. 联系技术支持

### API调用失败
1. 检查API密钥状态
2. 检查API用量限制
3. 检查网络连接
4. 启用备用方案

### 性能问题
1. 检查服务器资源使用
2. 启用CDN加速
3. 优化图片和静态资源
4. 升级服务器配置

## 📞 **技术支持联系方式**

- **项目仓库**: https://github.com/Coopermydog/DDmap
- **问题报告**: [GitHub Issues](https://github.com/Coopermydog/DDmap/issues)
- **文档**: README.md 和 DEPLOYMENT.md

---

**💡 小贴士**: 上线是一个迭代过程，不需要一次性做到完美。先确保核心功能正常，然后逐步优化。